<Window x:Class="WpfApp1.SLAEWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:WpfApp1"
        mc:Ignorable="d"
        Title="SLAE • Linear System Solver"
        Height="1077" Width="1920"
        WindowStartupLocation="CenterScreen"
        FontFamily="Segoe UI"
        Closing="Window_Closing">

    <Window.Resources>
        <!-- Palette -->
        <Color x:Key="C_Bg0">#0B1220</Color>
        <Color x:Key="C_Bg1">#0F1A2E</Color>
        <Color x:Key="C_Card">#121F39</Color>
        <Color x:Key="C_Stroke">#233A66</Color>
        <Color x:Key="C_Text1">#EAF0FF</Color>
        <Color x:Key="C_Text2">#A9B6D3</Color>
        <Color x:Key="C_Accent">#7C4DFF</Color>
        <Color x:Key="C_Accent2">#00D4FF</Color>

        <SolidColorBrush x:Key="Bg0" Color="{StaticResource C_Bg0}" />
        <SolidColorBrush x:Key="Bg1" Color="{StaticResource C_Bg1}" />
        <SolidColorBrush x:Key="Card" Color="{StaticResource C_Card}" />
        <SolidColorBrush x:Key="Stroke" Color="{StaticResource C_Stroke}" />
        <SolidColorBrush x:Key="Text1" Color="{StaticResource C_Text1}" />
        <SolidColorBrush x:Key="Text2" Color="{StaticResource C_Text2}" />
        <SolidColorBrush x:Key="Accent" Color="{StaticResource C_Accent}" />
        <SolidColorBrush x:Key="Accent2" Color="{StaticResource C_Accent2}" />

        <CornerRadius x:Key="R12">12</CornerRadius>

        <Style TargetType="{x:Type TextBlock}">
            <Setter Property="Foreground" Value="{StaticResource Text1}"/>
        </Style>

        <!-- Cards -->
        <Style x:Key="CardBorder" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource Card}"/>
            <Setter Property="BorderBrush" Value="{StaticResource Stroke}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="{StaticResource R12}"/>
            <Setter Property="Padding" Value="14"/>
        </Style>

        <Style x:Key="FieldCaption" TargetType="TextBlock">
            <Setter Property="Foreground" Value="{StaticResource Text2}"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Margin" Value="0,0,0,6"/>
        </Style>

        <Style x:Key="FieldBox" TargetType="TextBox">
            <Setter Property="Background" Value="{StaticResource Bg1}"/>
            <Setter Property="Foreground" Value="{StaticResource Text1}"/>
            <Setter Property="BorderBrush" Value="{StaticResource Stroke}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="10,7"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="CaretBrush" Value="{StaticResource Accent2}"/>
        </Style>

        <Style x:Key="FieldCombo" TargetType="ComboBox">
            <Setter Property="Background" Value="{StaticResource Bg1}"/>
            <Setter Property="Foreground" Value="{StaticResource Text1}"/>
            <Setter Property="BorderBrush" Value="{StaticResource Stroke}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Height" Value="34"/>
        </Style>

        <Style x:Key="DarkCheckBox" TargetType="CheckBox">
            <Setter Property="Foreground" Value="{StaticResource Text1}"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <!-- Buttons -->
        <Style x:Key="PrimaryButton" TargetType="Button">
            <Setter Property="Foreground" Value="{StaticResource Text1}"/>
            <Setter Property="Background" Value="{StaticResource Accent}"/>
            <Setter Property="BorderBrush" Value="{StaticResource Accent}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="14,10"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Border x:Name="B"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="{StaticResource R12}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="10"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Border Grid.Column="0" Background="{StaticResource Accent2}" CornerRadius="12,0,0,12"/>
                                <ContentPresenter Grid.Column="1"
                                                  HorizontalAlignment="Center"
                                                  VerticalAlignment="Center"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="B" Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect BlurRadius="18" ShadowDepth="0" Color="#5500D4FF"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="B" Property="Opacity" Value="0.88"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="B" Property="Opacity" Value="0.45"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="GhostButton" TargetType="Button">
            <Setter Property="Foreground" Value="{StaticResource Text1}"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="{StaticResource Stroke}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="12,10"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Border x:Name="B"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="{StaticResource R12}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="B" Property="Background" Value="#1AFFFFFF"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="B" Property="Background" Value="#12FFFFFF"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="B" Property="Opacity" Value="0.45"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="DangerButton" TargetType="Button" BasedOn="{StaticResource GhostButton}">
            <Setter Property="BorderBrush" Value="#FF4D4D"/>
            <Setter Property="Foreground" Value="#FFD6D6"/>
        </Style>

        <Style x:Key="AltButton" TargetType="Button" BasedOn="{StaticResource GhostButton}">
            <Setter Property="BorderBrush" Value="#B88CFF"/>
        </Style>

        <Style x:Key="SuccessButton" TargetType="Button" BasedOn="{StaticResource GhostButton}">
            <Setter Property="BorderBrush" Value="#2BE38B"/>
            <Setter Property="Foreground" Value="#D9FFEF"/>
        </Style>

        <!-- Menu -->
        <Style TargetType="{x:Type Menu}">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource Text1}"/>
        </Style>
        <Style TargetType="{x:Type MenuItem}">
            <Setter Property="Foreground" Value="{StaticResource Text1}"/>
            <Setter Property="Padding" Value="10,6"/>
        </Style>
        <Style TargetType="{x:Type Separator}">
            <Setter Property="Margin" Value="8,6"/>
            <Setter Property="Background" Value="{StaticResource Stroke}"/>
        </Style>

        <!-- DataGrid: dark -->
        <Style x:Key="DarkDataGrid" TargetType="DataGrid">
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="CanUserAddRows" Value="False"/>
            <Setter Property="CanUserDeleteRows" Value="False"/>
            <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
            <Setter Property="HorizontalScrollBarVisibility" Value="Auto"/>
            <Setter Property="Background" Value="#08111F"/>
            <Setter Property="Foreground" Value="{StaticResource Text1}"/>
            <Setter Property="BorderBrush" Value="{StaticResource Stroke}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="RowBackground" Value="#0B162A"/>
            <Setter Property="AlternatingRowBackground" Value="#08111F"/>
            <Setter Property="GridLinesVisibility" Value="All"/>
            <Setter Property="HorizontalGridLinesBrush" Value="#182B50"/>
            <Setter Property="VerticalGridLinesBrush" Value="#182B50"/>
            <Setter Property="HeadersVisibility" Value="All"/>
            <Setter Property="ColumnHeaderHeight" Value="34"/>
            <Setter Property="RowHeaderWidth" Value="46"/>
        </Style>

        <Style TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#0F1A2E"/>
            <Setter Property="Foreground" Value="{StaticResource Text2}"/>
            <Setter Property="BorderBrush" Value="{StaticResource Stroke}"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>

        <Style TargetType="DataGridRowHeader">
            <Setter Property="Background" Value="#0F1A2E"/>
            <Setter Property="Foreground" Value="{StaticResource Text2}"/>
            <Setter Property="BorderBrush" Value="{StaticResource Stroke}"/>
            <Setter Property="BorderThickness" Value="0,0,1,0"/>
        </Style>
    </Window.Resources>

    <Window.Background>
        <RadialGradientBrush Center="0.2,0.1" GradientOrigin="0.2,0.1" RadiusX="1.1" RadiusY="1.0">
            <GradientStop Color="#16264A" Offset="0"/>
            <GradientStop Color="#0B1220" Offset="0.55"/>
            <GradientStop Color="#070C16" Offset="1"/>
        </RadialGradientBrush>
    </Window.Background>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="320"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- LEFT SIDEBAR -->
        <Border Grid.Column="0" Background="#0B1428" BorderBrush="{StaticResource Stroke}" BorderThickness="0,0,1,0">
            <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                <StackPanel Margin="16">

                    <StackPanel Margin="0,0,0,14">
                        <TextBlock Text="SLAE Solver" FontSize="22" FontWeight="SemiBold"/>
                        <TextBlock Text="Решение A·X + B = 0 • импорт/экспорт • генерация"
                                   Foreground="{StaticResource Text2}" Margin="0,6,0,0" TextWrapping="Wrap"/>
                    </StackPanel>

                    <!-- Menu card (keep handlers) -->
                    <Border Style="{StaticResource CardBorder}" Padding="10" Margin="0,0,0,14">
                        <Menu>
                            <MenuItem Header="Файл">
                                <MenuItem Header="Импорт данных" Foreground="#FF08111F">
                                    <MenuItem Header="Из Excel (XLSX)" Click="ImportFromExcel_Click" Foreground="#FF08111F"/>
                                    <MenuItem Header="Из Google Tables" Click="ImportFromGoogleTables_Click" Foreground="#FF08111F"/>
                                    <Separator/>
                                    <MenuItem Header="Создать шаблон" Click="CreateTemplate_Click" Foreground="#FF08111F"/>
                                </MenuItem>
                                <MenuItem Header="Сгенерировать данные" Click="GenerateData_Click" Foreground="#FF08111F"/>
                                <Separator/>
                                <MenuItem Header="Экспорт в Excel (XLSX)" Click="ExportToExcel_Click" Foreground="#FF08111F"/>
                                <Separator/>
                                <MenuItem Header="Очистить" Click="ClearData_Click" Foreground="#FF08111F"/>
                                <Separator/>
                                <MenuItem Header="Выход" Click="Exit_Click" Foreground="#FF08111F"/>
                            </MenuItem>

                            <MenuItem Header="Методы">
                                <MenuItem Header="Выполнить все выбранные" Click="SolveAllSelectedMethods_Click" Foreground="#FF08111F"/>
                                <Separator/>
                                <MenuItem Header="Выбрать все методы" Click="SelectAllMethods_Click" Foreground="#FF08111F"/>
                                <MenuItem Header="Снять все выборы" Click="DeselectAllMethods_Click" Foreground="#FF08111F"/>
                                <Separator/>
                                <MenuItem Header="Метод Гаусса" Click="GaussMethod_Click" Foreground="#FF08111F"/>
                                <MenuItem Header="Метод Жордана-Гаусса" Click="JordanGaussMethod_Click" Foreground="#FF08111F"/>
                                <MenuItem Header="Метод Крамера" Click="CramerMethod_Click" Foreground="#FF08111F"/>
                            </MenuItem>

                            <MenuItem Header="Настройки">
                                <MenuItem Header="Сохранить интервал генерации" Click="SaveGenerationIntervals_Click" Foreground="#FF08111F"/>
                            </MenuItem>

                            <MenuItem Header="Справка">
                                <MenuItem Header="Инструкция по импорту" Click="HelpImport_Click" Foreground="#FF08111F"/>
                            </MenuItem>
                        </Menu>
                    </Border>

                    <!-- Methods selection -->
                    <Border Style="{StaticResource CardBorder}" Margin="0,0,0,14">
                        <StackPanel>
                            <TextBlock Text="Выбор методов" Foreground="{StaticResource Text2}" Margin="0,0,0,10"/>
                            <CheckBox x:Name="chkGauss" Content="Метод Гаусса" Style="{StaticResource DarkCheckBox}" IsChecked="True"/>
                            <CheckBox x:Name="chkJordanGauss" Content="Метод Жордана-Гаусса" Style="{StaticResource DarkCheckBox}" IsChecked="True"/>
                            <CheckBox x:Name="chkCramer" Content="Метод Крамера" Style="{StaticResource DarkCheckBox}"/>

                            <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                <Button Content="Все" Click="SelectAllMethods_Click" Style="{StaticResource GhostButton}" Width="92"/>
                                <Button Content="Ничего" Click="DeselectAllMethods_Click" Style="{StaticResource GhostButton}" Width="92" Margin="10,0,0,0"/>
                            </StackPanel>

                            <Button Content="Выполнить все выбранные"
                                    Click="SolveAllSelectedMethods_Click"
                                    Style="{StaticResource PrimaryButton}"
                                    Margin="0,12,0,0"/>
                        </StackPanel>
                    </Border>

                    <!-- Generation -->
                    <Border Style="{StaticResource CardBorder}" Margin="0,0,0,14">
                        <StackPanel>
                            <TextBlock Text="Генерация данных" Foreground="{StaticResource Text2}" Margin="0,0,0,10"/>

                            <TextBlock Text="Интервал значений" Style="{StaticResource FieldCaption}"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="12"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="От" Style="{StaticResource FieldCaption}" Margin="0,0,0,4"/>
                                    <TextBox x:Name="txtMinValue" Text="-10" Style="{StaticResource FieldBox}"/>
                                </StackPanel>

                                <StackPanel Grid.Column="2">
                                    <TextBlock Text="До" Style="{StaticResource FieldCaption}" Margin="0,0,0,4"/>
                                    <TextBox x:Name="txtMaxValue" Text="10" Style="{StaticResource FieldBox}"/>
                                </StackPanel>
                            </Grid>

                            <Button Content="Сгенерировать данные"
                                    Click="GenerateData_Click"
                                    Style="{StaticResource GhostButton}"
                                    Margin="0,12,0,0"/>
                        </StackPanel>
                    </Border>

                    <!-- Size -->
                    <Border Style="{StaticResource CardBorder}" Margin="0,0,0,14">
                        <StackPanel>
                            <TextBlock Text="Размер матрицы" Foreground="{StaticResource Text2}" Margin="0,0,0,10"/>
                            <ComboBox x:Name="MatrixSizeComboBox"
                                      SelectionChanged="MatrixSizeComboBox_SelectionChanged"
                                      Style="{StaticResource FieldCombo}">
                                <ComboBoxItem Content="2" IsSelected="True" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="3" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="4" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="5" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="6" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="7" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="8" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="9" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="10" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="11" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="12" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="13" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="14" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="15" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="16" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="17" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="18" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="19" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="20" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="21" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="22" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="23" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="24" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="25" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="26" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="27" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="28" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="29" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="30" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="31" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="32" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="33" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="34" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="35" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="36" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="37" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="38" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="39" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="40" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="41" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="42" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="43" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="44" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="45" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="46" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="47" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="48" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="49" Foreground="#FF08111F"/>
                                <ComboBoxItem Content="50" Foreground="#FF08111F"/>
                            </ComboBox>
                        </StackPanel>
                    </Border>

                    <!-- Quick actions -->
                    <Border Style="{StaticResource CardBorder}">
                        <StackPanel>
                            <TextBlock Text="Быстрые действия" Foreground="{StaticResource Text2}" Margin="0,0,0,10"/>
                            <Button Content="Очистить" Click="ClearData_Click" Style="{StaticResource DangerButton}"/>
                            <Button Content="Создать шаблон" Click="CreateTemplate_Click" Style="{StaticResource AltButton}" Margin="0,10,0,0"/>
                        </StackPanel>
                    </Border>

                </StackPanel>
            </ScrollViewer>
        </Border>

        <!-- MAIN -->
        <Grid Grid.Column="1" Margin="18">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <Border Grid.Row="0" Style="{StaticResource CardBorder}" Padding="16" Margin="0,0,0,14">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel>
                        <TextBlock Text="Решение СЛАУ A·X + B = 0" FontSize="20" FontWeight="SemiBold"/>
                        <TextBlock Text="Матрица A (N×N), вектор B (N×1) → решение X"
                                   Foreground="{StaticResource Text2}" Margin="0,6,0,0"/>
                    </StackPanel>

                    <Border Grid.Column="1"
                            Background="#1A00D4FF"
                            BorderBrush="{StaticResource Accent2}"
                            BorderThickness="1"
                            CornerRadius="999"
                            Padding="10,6"
                            VerticalAlignment="Center">
                        <TextBlock Text="Linear Algebra"/>
                    </Border>
                </Grid>
            </Border>

            <!-- Center content -->
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="420"/>
                </Grid.ColumnDefinitions>

                <!-- Matrices -->
                <Grid Grid.Column="0" Margin="0,0,14,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" Style="{StaticResource CardBorder}" Padding="12" Margin="0,0,0,14">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="Матрица A (N×N)" FontWeight="SemiBold" FontSize="14" Margin="6,4,6,10"/>
                            <DataGrid x:Name="MatrixADataGrid"
                  Grid.Row="1"
                  Style="{StaticResource DarkDataGrid}"
                  LoadingRow="DataGrid_LoadingRow" SelectionChanged="MatrixADataGrid_SelectionChanged"/>
                        </Grid>
                    </Border>

                    <Border Grid.Row="1" Style="{StaticResource CardBorder}" Padding="12">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <TextBlock Text="Вектор B (N×1)" FontWeight="SemiBold" FontSize="14" Margin="6,4,6,10"/>
                            <DataGrid x:Name="VectorBDataGrid"
                                      Grid.Row="1"
                                      Style="{StaticResource DarkDataGrid}"
                                      LoadingRow="DataGrid_LoadingRow" Foreground="#FFF7FFEA"/>
                        </Grid>
                    </Border>
                </Grid>

                <Border Grid.Column="1" Style="{StaticResource CardBorder}">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <TextBlock Text="Результаты" FontSize="16" FontWeight="SemiBold"/>
                            <TextBlock Text="Вектор X + время выполнения + статус"
                       Foreground="{StaticResource Text2}" Margin="0,6,0,14"/>

                            <Border Background="#08111F" BorderBrush="{DynamicResource Text2}" BorderThickness="1"
                    CornerRadius="10" Padding="10" Margin="0,0,0,12">
                                <StackPanel>
                                    <TextBlock Text="Решение (вектор X)" FontWeight="SemiBold" Margin="0,0,0,10"/>
                                    <DataGrid x:Name="VectorXDataGrid"
                              Style="{StaticResource DarkDataGrid}"
                              IsReadOnly="True"
                              Height="240"/>
                                </StackPanel>
                            </Border>

                            <Border Background="#08111F" BorderBrush="{StaticResource Stroke}" BorderThickness="1"
                    CornerRadius="10" Padding="10" Margin="0,0,0,12">
                                <StackPanel>
                                    <TextBlock Text="Время выполнения" FontWeight="SemiBold" Margin="0,0,0,10"/>
                                    <TextBox x:Name="ExecutionTimeTextBox"
                             IsReadOnly="True"
                             Height="140"
                             Background="#08111F"
                             Foreground="{StaticResource Text1}"
                             BorderBrush="{StaticResource Stroke}"
                             BorderThickness="1"
                             VerticalScrollBarVisibility="Auto"
                             TextWrapping="Wrap"
                             FontFamily="Consolas"
                             FontSize="12"
                             Padding="10"/>
                                </StackPanel>
                            </Border>

                            <Border x:Name="StatusBorder"
                    BorderBrush="#FFCC00"
                    BorderThickness="1"
                    Background="#12FFCC00"
                    CornerRadius="10"
                    Padding="10"
                    Visibility="Collapsed">
                                <TextBlock x:Name="StatusTextBlock" TextWrapping="Wrap" Foreground="{StaticResource Text1}"/>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </Border>
            </Grid>

            <Border Grid.Row="2" Style="{StaticResource CardBorder}" Padding="12" Margin="0,14,0,0">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                    <Button x:Name="CalculateGaussBtn" Content="Метод Гаусса"
                Click="GaussMethod_Click" Style="{StaticResource GhostButton}" Width="160"/>
                    <Button x:Name="CalculateJordanGaussBtn" Content="Жордана‑Гаусса"
                Click="JordanGaussMethod_Click" Style="{StaticResource GhostButton}" Width="170" Margin="10,0,0,0"/>
                    <Button x:Name="CalculateCramerBtn" Content="Метод Крамера"
                Click="CramerMethod_Click" Style="{StaticResource GhostButton}" Width="150" Margin="10,0,0,0"/>
                    <Button x:Name="ClearBtn" Content="Очистить"
                Click="ClearData_Click" Style="{StaticResource DangerButton}" Width="120" Margin="10,0,0,0"/>
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</Window>
