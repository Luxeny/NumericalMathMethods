<Window x:Class="WpfApp1.LeastSquaresWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:oxy="http://oxyplot.org/wpf"
        mc:Ignorable="d"
        Title="Least Squares • Approximation"
        Height="1080" Width="1920"
        WindowStartupLocation="CenterScreen"
        FontFamily="Segoe UI"
        Closing="Window_Closing">

    <Window.Resources>
        <!-- Palette -->
        <Color x:Key="C_Bg0">#0B1220</Color>
        <Color x:Key="C_Bg1">#0F1A2E</Color>
        <Color x:Key="C_Card">#121F39</Color>
        <Color x:Key="C_Stroke">#233A66</Color>
        <Color x:Key="C_Text1">#EAF0FF</Color>
        <Color x:Key="C_Text2">#A9B6D3</Color>
        <Color x:Key="C_Accent">#7C4DFF</Color>
        <Color x:Key="C_Accent2">#00D4FF</Color>

        <SolidColorBrush x:Key="Bg0" Color="{StaticResource C_Bg0}"/>
        <SolidColorBrush x:Key="Bg1" Color="{StaticResource C_Bg1}"/>
        <SolidColorBrush x:Key="Card" Color="{StaticResource C_Card}"/>
        <SolidColorBrush x:Key="Stroke" Color="{StaticResource C_Stroke}"/>
        <SolidColorBrush x:Key="Text1" Color="{StaticResource C_Text1}"/>
        <SolidColorBrush x:Key="Text2" Color="{StaticResource C_Text2}"/>
        <SolidColorBrush x:Key="Accent" Color="{StaticResource C_Accent}"/>
        <SolidColorBrush x:Key="Accent2" Color="{StaticResource C_Accent2}"/>

        <CornerRadius x:Key="R12">12</CornerRadius>

        <Style TargetType="{x:Type TextBlock}">
            <Setter Property="Foreground" Value="{StaticResource Text1}"/>
        </Style>

        <!-- Cards -->
        <Style x:Key="CardBorder" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource Card}"/>
            <Setter Property="BorderBrush" Value="{StaticResource Stroke}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="{StaticResource R12}"/>
            <Setter Property="Padding" Value="14"/>
        </Style>

        <Style x:Key="FieldCaption" TargetType="TextBlock">
            <Setter Property="Foreground" Value="{StaticResource Text2}"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Margin" Value="0,0,0,6"/>
        </Style>

        <Style x:Key="FieldBox" TargetType="TextBox">
            <Setter Property="Background" Value="{StaticResource Bg1}"/>
            <Setter Property="Foreground" Value="{StaticResource Text1}"/>
            <Setter Property="BorderBrush" Value="{StaticResource Stroke}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="10,7"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="CaretBrush" Value="{StaticResource Accent2}"/>
            <Setter Property="Height" Value="34"/>
        </Style>

        <Style x:Key="DarkCheckBox" TargetType="CheckBox">
            <Setter Property="Foreground" Value="{StaticResource Text1}"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
        </Style>

        <!-- Buttons -->
        <Style x:Key="PrimaryButton" TargetType="Button">
            <Setter Property="Foreground" Value="{StaticResource Text1}"/>
            <Setter Property="Background" Value="{StaticResource Accent}"/>
            <Setter Property="BorderBrush" Value="{StaticResource Accent}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="14,10"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Border x:Name="B"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="{StaticResource R12}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="10"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Border Grid.Column="0" Background="{StaticResource Accent2}" CornerRadius="12,0,0,12"/>
                                <ContentPresenter Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="B" Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect BlurRadius="18" ShadowDepth="0" Color="#5500D4FF"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="B" Property="Opacity" Value="0.88"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="B" Property="Opacity" Value="0.45"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="GhostButton" TargetType="Button">
            <Setter Property="Foreground" Value="{StaticResource Text1}"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="{StaticResource Stroke}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="12,10"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Border x:Name="B"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="{StaticResource R12}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="B" Property="Background" Value="#1AFFFFFF"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="B" Property="Background" Value="#12FFFFFF"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="B" Property="Opacity" Value="0.45"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="DangerButton" TargetType="Button" BasedOn="{StaticResource GhostButton}">
            <Setter Property="BorderBrush" Value="#FF4D4D"/>
            <Setter Property="Foreground" Value="#FFD6D6"/>
        </Style>

        <Style x:Key="AltButton" TargetType="Button" BasedOn="{StaticResource GhostButton}">
            <Setter Property="BorderBrush" Value="#B88CFF"/>
        </Style>

        <!-- Menu -->
        <Style TargetType="{x:Type Menu}">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource Text1}"/>
        </Style>
        <Style TargetType="{x:Type MenuItem}">
            <Setter Property="Foreground" Value="{StaticResource Text1}"/>
            <Setter Property="Padding" Value="10,6"/>
        </Style>
        <Style TargetType="{x:Type Separator}">
            <Setter Property="Margin" Value="8,6"/>
            <Setter Property="Background" Value="{StaticResource Stroke}"/>
        </Style>

        <!-- DataGrid (dark) -->
        <Style x:Key="DarkDataGrid" TargetType="DataGrid">
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="CanUserAddRows" Value="True"/>
            <Setter Property="CanUserDeleteRows" Value="False"/>
            <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
            <Setter Property="HorizontalScrollBarVisibility" Value="Auto"/>
            <Setter Property="Background" Value="#08111F"/>
            <Setter Property="Foreground" Value="{StaticResource Text1}"/>
            <Setter Property="BorderBrush" Value="{StaticResource Stroke}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="RowBackground" Value="#0B162A"/>
            <Setter Property="AlternatingRowBackground" Value="#08111F"/>
            <Setter Property="GridLinesVisibility" Value="All"/>
            <Setter Property="HorizontalGridLinesBrush" Value="#182B50"/>
            <Setter Property="VerticalGridLinesBrush" Value="#182B50"/>
            <Setter Property="HeadersVisibility" Value="All"/>
            <Setter Property="ColumnHeaderHeight" Value="34"/>
            <Setter Property="RowHeaderWidth" Value="46"/>
        </Style>

        <Style TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#0F1A2E"/>
            <Setter Property="Foreground" Value="{StaticResource Text2}"/>
            <Setter Property="BorderBrush" Value="{StaticResource Stroke}"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>

        <Style TargetType="DataGridRowHeader">
            <Setter Property="Background" Value="#0F1A2E"/>
            <Setter Property="Foreground" Value="{StaticResource Text2}"/>
            <Setter Property="BorderBrush" Value="{StaticResource Stroke}"/>
            <Setter Property="BorderThickness" Value="0,0,1,0"/>
        </Style>

        <!-- Mono output -->
        <Style x:Key="MonoBox" TargetType="TextBox" BasedOn="{StaticResource FieldBox}">
            <Setter Property="FontFamily" Value="Consolas"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Height" Value="Auto"/>
            <Setter Property="MinHeight" Value="120"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
        </Style>
    </Window.Resources>

    <Window.Background>
        <RadialGradientBrush Center="0.2,0.1" GradientOrigin="0.2,0.1" RadiusX="1.1" RadiusY="1.0">
            <GradientStop Color="#16264A" Offset="0"/>
            <GradientStop Color="#0B1220" Offset="0.55"/>
            <GradientStop Color="#070C16" Offset="1"/>
        </RadialGradientBrush>
    </Window.Background>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="340"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- LEFT SIDEBAR -->
        <Border Grid.Column="0" Background="#0B1428" BorderBrush="{StaticResource Stroke}" BorderThickness="0,0,1,0">
            <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                <StackPanel Margin="16">

                    <StackPanel Margin="0,0,0,14">
                        <TextBlock Text="Least Squares" FontSize="22" FontWeight="SemiBold"/>
                        <TextBlock Text="Аппроксимация полиномами n=1 и n=2 • импорт/экспорт • генерация"
                                   Foreground="{StaticResource Text2}" Margin="0,6,0,0" TextWrapping="Wrap"/>
                    </StackPanel>

                    <!-- Menu card (keep handlers) -->
                    <Border Style="{StaticResource CardBorder}" Padding="10" Margin="0,0,0,14">
                        <Menu>
                            <MenuItem Header="Файл">
                                <MenuItem Header="Импорт данных" Foreground="#FF08111F">
                                    <MenuItem Header="Из Excel (XLSX)" Foreground="#FF08111F" Click="ImportFromExcel_Click"/>
                                    <MenuItem Header="Из Google Таблиц" Foreground="#FF08111F" Click="ImportFromGoogleTables_Click"/>
                                    <Separator/>
                                    <MenuItem Header="Создать шаблон" Foreground="#FF08111F" Click="CreateTemplate_Click"/>
                                </MenuItem>
                                <MenuItem Header="Сгенерировать данные" Foreground="#FF08111F" Click="GenerateData_Click"/>
                                <Separator/>
                                <MenuItem Header="Экспорт в Excel (XLSX)" Foreground="#FF08111F" Click="ExportToExcel_Click"/>
                                <Separator/>
                                <MenuItem Header="Очистить всё" Foreground="#FF08111F" Click="ClearData_Click"/>
                                <Separator/>
                                <MenuItem Header="Выход" Foreground="#FF08111F" Click="Exit_Click"/>
                            </MenuItem>

                            <MenuItem Header="Вычисления">
                                <MenuItem Header="Выполнить все выбранные" Foreground="#FF08111F" Click="CalculateAllSelected_Click"/>
                                <Separator/>
                                <MenuItem Header="Выбрать все методы" Foreground="#FF08111F" Click="SelectAllMethods_Click"/>
                                <MenuItem Header="Сбросить все методы" Foreground="#FF08111F" Click="DeselectAllMethods_Click"/>
                                <Separator/>
                                <MenuItem Header="Линейная аппроксимация (n=1)" Foreground="#FF08111F" Click="LinearApproximation_Click"/>
                                <MenuItem Header="Квадратичная аппроксимация (n=2)" Foreground="#FF08111F" Click="QuadraticApproximation_Click"/>
                            </MenuItem>

                            <MenuItem Header="Вид">
                                <MenuItem Header="Показать графики" Foreground="#FF08111F" Click="ShowGraphs_Click"/>
                                <MenuItem Header="Скрыть графики" Foreground="#FF08111F" Click="HideGraphs_Click"/>
                            </MenuItem>

                            <MenuItem Header="Настройки">
                                <MenuItem Header="Сохранить интервалы генерации" Foreground="#FF08111F" Click="SaveGenerationIntervals_Click"/>
                            </MenuItem>

                            <MenuItem Header="Помощь">
                                <MenuItem Header="Инструкции по импорту" Foreground="#FF08111F" Click="HelpImport_Click"/>
                            </MenuItem>
                        </Menu>
                    </Border>

                    <!-- Methods -->
                    <Border Style="{StaticResource CardBorder}" Margin="0,0,0,14">
                        <StackPanel>
                            <TextBlock Text="Методы аппроксимации" Foreground="{StaticResource Text2}" Margin="0,0,0,10"/>
                            <CheckBox x:Name="chkLinear" Content="Линейная (n=1)" Style="{StaticResource DarkCheckBox}" IsChecked="True"/>
                            <CheckBox x:Name="chkQuadratic" Content="Квадратичная (n=2)" Style="{StaticResource DarkCheckBox}" IsChecked="True"/>

                            <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                <Button Content="Все" Click="SelectAllMethods_Click" Style="{StaticResource GhostButton}" Width="92"/>
                                <Button Content="Ничего" Click="DeselectAllMethods_Click" Style="{StaticResource GhostButton}" Width="92" Margin="10,0,0,0"/>
                            </StackPanel>

                            <Button Content="Выполнить расчёт"
                                    Click="CalculateAllSelected_Click"
                                    Style="{StaticResource PrimaryButton}"
                                    Margin="0,12,0,0"/>
                        </StackPanel>
                    </Border>

                    <!-- Generation -->
                    <Border Style="{StaticResource CardBorder}" Margin="0,0,0,14">
                        <StackPanel>
                            <TextBlock Text="Генерация данных" Foreground="{StaticResource Text2}" Margin="0,0,0,10"/>

                            <TextBlock Text="Количество точек" Style="{StaticResource FieldCaption}"/>
                            <TextBox x:Name="txtPointCount" Text="10" Style="{StaticResource FieldBox}"/>

                            <TextBlock Text="Диапазон X" Style="{StaticResource FieldCaption}" Margin="0,12,0,4"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="12"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="txtMinX" Text="-10" Style="{StaticResource FieldBox}"/>
                                <TextBox x:Name="txtMaxX" Text="10" Grid.Column="2" Style="{StaticResource FieldBox}"/>
                            </Grid>

                            <TextBlock Text="Диапазон Y" Style="{StaticResource FieldCaption}" Margin="0,12,0,4"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="12"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="txtMinY" Text="-50" Style="{StaticResource FieldBox}"/>
                                <TextBox x:Name="txtMaxY" Text="50" Grid.Column="2" Style="{StaticResource FieldBox}"/>
                            </Grid>

                            <Button Content="Сгенерировать данные"
                                    Click="GenerateData_Click"
                                    Style="{StaticResource GhostButton}"
                                    Margin="0,12,0,0"/>
                        </StackPanel>
                    </Border>

                    <!-- History -->
                    <Border Style="{StaticResource CardBorder}" Margin="0,0,0,14">
                        <StackPanel>
                            <TextBlock Text="История точек" Foreground="{StaticResource Text2}" Margin="0,0,0,10"/>
                            <DataGrid x:Name="HistoryDataGrid"
                                      Style="{StaticResource DarkDataGrid}"
                                      IsReadOnly="True"
                                      Height="220"/>
                        </StackPanel>
                    </Border>

                    <!-- Point management -->
                    <Border Style="{StaticResource CardBorder}">
                        <StackPanel>
                            <TextBlock Text="Управление точками" Foreground="{StaticResource Text2}" Margin="0,0,0,10"/>
                            <Button Content="Добавить точку" Click="AddPoint_Click" Style="{StaticResource GhostButton}"/>
                            <Button Content="Удалить выбранную" Click="RemoveSelectedPoint_Click" Style="{StaticResource DangerButton}" Margin="0,10,0,0"/>
                            <Button Content="Удалить последнюю" Click="RemoveLastPoint_Click" Style="{StaticResource AltButton}" Margin="0,10,0,0"/>
                            <TextBlock Text="Можно удалять точки клавишей Delete"
                                       Foreground="{StaticResource Text2}" FontSize="11" Margin="0,10,0,0"/>
                        </StackPanel>
                    </Border>

                </StackPanel>
            </ScrollViewer>
        </Border>

        <!-- MAIN -->
        <Grid Grid.Column="1" Margin="18">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <Border Grid.Row="0" Style="{StaticResource CardBorder}" Padding="16" Margin="0,0,0,14">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel>
                        <TextBlock Text="Метод наименьших квадратов" FontSize="20" FontWeight="SemiBold"/>
                        <TextBlock Text="Аппроксимация точек полиномами степени n=1 и n=2"
                                   Foreground="{StaticResource Text2}" Margin="0,6,0,0"/>
                    </StackPanel>

                    <Border Grid.Column="1"
                            Background="#1A00D4FF"
                            BorderBrush="{StaticResource Accent2}"
                            BorderThickness="1"
                            CornerRadius="999"
                            Padding="10,6"
                            VerticalAlignment="Center">
                        <TextBlock Text="Approximation"/>
                    </Border>
                </Grid>
            </Border>

            <!-- Content: points+plot + results -->
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="420"/>
                </Grid.ColumnDefinitions>

                <!-- Center: points + plot -->
                <Grid Grid.Column="0" Margin="0,0,14,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="360"/>
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" Style="{StaticResource CardBorder}" Padding="12" Margin="0,0,0,14">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <DockPanel Grid.Row="0" Margin="6,4,6,10">
                                <TextBlock Text="Текущие точки (редактируемые)" FontWeight="SemiBold" FontSize="14" DockPanel.Dock="Left"/>
                                <TextBlock Text="DataGrid" Foreground="{StaticResource Text2}" DockPanel.Dock="Right"/>
                            </DockPanel>

                            <DataGrid x:Name="PointsDataGrid"
                                      Grid.Row="1"
                                      Style="{StaticResource DarkDataGrid}"
                                      AutoGeneratingColumn="PointsDataGrid_AutoGeneratingColumn"/>
                        </Grid>
                    </Border>

                    <Border Grid.Row="1" Style="{StaticResource CardBorder}" Padding="12">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <DockPanel Grid.Row="0" Margin="6,4,6,10">
                                <TextBlock Text="График аппроксимации" FontWeight="SemiBold" FontSize="14" DockPanel.Dock="Left"/>
                                <TextBlock Text="OxyPlot" Foreground="{StaticResource Text2}" DockPanel.Dock="Right"/>
                            </DockPanel>

                            <Border Grid.Row="1" Background="White" BorderBrush="{StaticResource Stroke}" BorderThickness="1" CornerRadius="10" Padding="8">
                                <oxy:PlotView x:Name="PlotView" Background="Transparent"/>
                            </Border>
                        </Grid>
                    </Border>
                </Grid>

                <!-- Right: results -->
                <Border Grid.Column="1" Style="{StaticResource CardBorder}">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <TextBlock Text="Результаты" FontSize="16" FontWeight="SemiBold"/>
                            <TextBlock Text="Линейная, квадратичная и сравнение" Foreground="{StaticResource Text2}" Margin="0,6,0,14"/>

                            <Border Background="#08111F" BorderBrush="{StaticResource Stroke}" BorderThickness="1"
        CornerRadius="10" Padding="10" Margin="0,0,0,12">
                                <StackPanel>
                                    <TextBlock Text="Линейная аппроксимация (n=1)" FontWeight="SemiBold" Margin="0,0,0,10"/>
                                    <TextBox x:Name="txtLinearResults" IsReadOnly="True" Style="{StaticResource MonoBox}" MinHeight="160"/>
                                </StackPanel>
                            </Border>

                            <Border Background="#08111F" BorderBrush="{StaticResource Stroke}" BorderThickness="1"
        CornerRadius="10" Padding="10" Margin="0,0,0,12">
                                <StackPanel>
                                    <TextBlock Text="Квадратичная аппроксимация (n=2)" FontWeight="SemiBold" Margin="0,0,0,10"/>
                                    <TextBox x:Name="txtQuadraticResults" IsReadOnly="True" Style="{StaticResource MonoBox}" MinHeight="160"/>
                                </StackPanel>
                            </Border>

                            <Border Background="#08111F" BorderBrush="{StaticResource Stroke}" BorderThickness="1"
        CornerRadius="10" Padding="10" Margin="0,0,0,12">
                                <StackPanel>
                                    <TextBlock Text="Сравнение методов" FontWeight="SemiBold" Margin="0,0,0,10"/>
                                    <TextBox x:Name="txtComparison" IsReadOnly="True" Style="{StaticResource MonoBox}" MinHeight="120" FontSize="11"/>
                                </StackPanel>
                            </Border>


                            <Border x:Name="StatusBorder"
                                    BorderBrush="#FF7C4DFF"
                                    BorderThickness="1"
                                    Background="#12FFCC00"
                                    CornerRadius="10"
                                    Padding="10"
                                    Visibility="Collapsed">
                                <TextBlock x:Name="StatusTextBlock" TextWrapping="Wrap" Foreground="{StaticResource Text1}"/>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </Border>
            </Grid>
        </Grid>
    </Grid>
</Window>
